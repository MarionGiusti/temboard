{% extends "base.html" %}

{% block title %}temBoard / Settings / Instances / Groups{% endblock %}

{% block head %}
{% for link in vitejs.css_links_for('settings.instance-groups.js') %}{{ link|safe }}{% endfor %}
{% endblock %}

<!-- sidebar -->
{% block sidebar %} {% include "settings/nav.html" %} {% endblock %}

{% block content %}
<div id="vue-app">
  <environment-migration-dialog ref="environment_migration_dialog" object-class="group" title="Instance group in multiple user groups"></environment-migration-dialog>
  <edit-group-dialog kind="instance" ref="editModal"></edit-group-dialog>
  {% raw %}
  <DeleteDialog ref="deleteModal" title="Delete group" v-slot="{resource}">
      <p class="fs-5 text-center">Please confirm the deletion of group <strong>{{resource.name}}</strong>.</p>
  </DeleteDialog>
  {% endraw %}

  <div class="row text-end">
    <p>
      <button id="buttonLoadAddGroupForm" class="btn btn-success btn-sm"
        @click.prevent="$refs.editModal.open()"
      >
        New group
      </button>
    </p>
  </div>

  <div class="row">
   <table class="table table-striped table-bordered table-hover" id="tableGroups" cellspacing="0">
   <thead>
     <tr>
       <th>Name</th>
       <th>Description</th>
       <th>User groups</th>
       <th data-dt-order="disable"></th>
     </tr>
   </thead>
   <tbody>
   {% for group in groups %}
     <tr>
       <td>{{group.group_name}}</td>
       <td>{{group.group_description}}</td>
       <td>{% for ari in group.ari %} <span class="badge border text-body-secondary">{{ari.role_group_name}}</span>{% endfor %}
         {% if group.ari|length > 1 %}
           <i
             class="fa fa-warning text-warning"
             style="cursor: pointer;"
             title="Group in multiple user groups. Click for details."
             data-bs-toggle="modal"
             v-on:click="$refs.environment_migration_dialog.show()">
           </i>
         {% endif %}
       </td>
       <td class="text-center">
         <button
           type="button"
           class="btn btn-outline-secondary btn-sm m-1"
           data-bs-toggle="tooltip"
           data-bs-placement="bottom"
           data-action="edit"
           title="Edit"
           @click.prevent="$refs.editModal.open('{{ group.group_name }}')"
         ><i class="fa fa-edit"></i>
         </button>
         <button
           type="button"
           class="btn btn-outline-secondary btn-sm"
           data-bs-toggle="tooltip"
           data-bs-placement="bottom"
           data-action="delete"
           title="Delete"
           @click.prevent="$refs.deleteModal.open('/json/groups/instance/{{ group.group_name }}')"
         ><i class="fa fa-trash-o"></i></button>
       </td>
     </tr>
   {% endfor %}
   </tbody>
   </table>
 </div>

 <script type="module" src="{{ vitejs.url_for('settings.instance-groups.js') }}"></script>
{% endblock %}
